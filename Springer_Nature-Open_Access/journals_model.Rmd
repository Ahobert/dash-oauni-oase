---
title: "Journals' business model"
subtitle: "of journals in Springer Nature"
output:
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
    theme: spacelab
    source_code: embed
    fontsize: 16pt
---

```{js include = FALSE}
function filter_default() {
    document.getElementById("GENDER").getElementsByClassName("selectized") 
[0].selectize.setValue("both", false);
 }
$(document).ready(filter_default);
```

```{r include = FALSE}
knitr::opts_chunk$set(echo=FALSE,warning=FALSE,message=FALSE)
```

```{r setup}
library(knitr)
library(plotly)
library(crosstalk)
library(htmltools)
library(dplyr)

myfont="Times New Roman"
knitr::opts_chunk$set(echo = FALSE)

journal_model_field<-read.table("sn_journal_model_fied.csv",header=TRUE,sep=",",quote="\r",dec = ".")
journal_model_all<-read.table("sn_journal_model.csv",header=TRUE,sep=",",quote="\r",dec = ".")
sharedJournal_model_all<-SharedData$new(journal_model_all)
colors=c("grey","#C08DDF", "#FFD700","red")
plt_all<-plot_ly(data=journal_model_all,labels=~Model, values=~NUM_JOURNALS, type="pie",textinfo = "value",marker = list(colors = colors)) %>% 
    layout(title = list(text='<b>Distrubtion of all journals by business model</b>',font=list(
      size = 16
      )),
      legend = list(font = list(size=16)),
           width = 405, height = 405,
           xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
           yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))


sharedJournal_model_field<-SharedData$new(journal_model_field)
plt_field_journals<-
  ggplot(data=sharedJournal_model_field,aes(x=reorder(Model,desc(Model)), y=NUM_ITEMS,fill=Model )) +
  geom_col(position=position_dodge(), stat="identity",width=0.5,show.legend=FALSE) +
  scale_fill_manual(values=c("red","#FFD700", "#C08DDF"))+   
  theme_minimal()+
  labs(x="Scientific fields", y="Number of journals",#,
       caption = "(b)")+#"Percentage of articles published in journals 3 models across four groups of countries") +
  theme( text = element_text(family=myfont,size=16),
         axis.title.x=element_blank(),
         axis.title = element_text(face="bold"),
         plot.caption = element_text(hjust = 0),
         legend.title=element_text(face = "bold"),
         legend.text= element_text(face="plain"),
         axis.text  =  element_text( family=myfont,face = "bold"),
         axis.text.x=element_blank())



ply_field_journals<-ggplotly(plt_field_journals,height=400)

bscols(widths = c(10,10,10),
       list(plt_all,
         filter_select(id = "FIELD", label = "Filter based on field",
                       sharedData = sharedJournal_model_field, group = ~ FIELD,multiple=FALSE,allLevels = FALSE)
       ),ply_field_journals
       )

```

```{css}
.crosstalk-input {
  margin-left: 15px;
}
```
These two charts show the journals' business model distribution in Springer Nature. The Pie chart presents the distribution for all journals, and the bar chart displays it per field (each bar indicates the number of journals for each model in the filtered field).